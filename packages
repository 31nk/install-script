#!/bin/bash

# Update system
echo "Updating system..."
sudo pacman -Syu --noconfirm

# Install pacman packages
echo "Installing pacman packages..."
sudo pacman -S --noconfirm --needed hyprland kitty git steam code neovim playerctl wofi flatpak thunar os-prober swww neovide fastfetch steam neovide

# Check if paru is already installed, and install it if not
if ! command -v paru &>/dev/null; then
  echo "Getting paru for AUR packages..."
  git clone https://aur.archlinux.org/paru.git
  cd yay || exit 1 # Exit if we can't change to the paru directory
  makepkg -si
  cd .. || exit 1 # Return to previous directory
else
  echo "paru is already installed."
fi

echo "Done"

echo "AUR packages may need dependencies installed, this may take a bit..."

# Install AUR packages
paru -S --noconfirm ags-hyprpanel-git brave-bin vesktop

echo "Done"

echo "Copying hyprland config files"

# Clone Hyprland configuration repo
git clone https://github.com/31nk/hyprland.git

# Hyprland configuration copy prompt
read -p "Do you want to copy Hyprland files to ~/.config? (y/n): " answer

if [[ "$answer" == "y" || "$answer" == "Y" ]]; then
  echo "Copying files to ~/.config..."
  cd hyprland || exit 1 # Ensure we are in the correct directory
  cp -r * ~/.config/    # Copy all files to ~/.config, avoid overwriting specific files
  cd .. || exit 1       # Return to the previous directory
elif [[ "$answer" == "n" || "$answer" == "N" ]]; then
  echo "Skipping file copy."
else
  echo "Invalid input. Please enter 'y' or 'n'."
  exit 1
fi

echo "Done."
